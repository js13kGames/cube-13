!function(){"use strict";let F=document,t=devicePixelRatio,e=F=>F.getContext("2d"),o=()=>e(F.createElement("canvas")),i=F=>F.canvas,r=F=>i(F).width,l=F=>i(F).height,a=(F,t)=>i(F).width=t,n=(F,t)=>i(F).height=t,f=F=>F.resetTransform(),d=()=>performance.now(),X={o:d(),i:0},c=[],u=F=>F,s=F=>F*F,W=(F,t,e,o,i,r,l)=>{let a=F[t];c.push({r:F,l:t,n:a,p:e,m:0,offsetS:o,v:i,easing:r,h:l})},b=16,p=(F,t,e,o)=>({w:F,g:t,k:F+e,V:t+o}),Y=Math,m=Y.floor,G=Y.min,y=Y.max,M=Y.hypot,A=Y.abs,v=Y.random,h=(F,t)=>{let e=(F=>M(F.x,F.y))(F);e>0&&(e=t/e,F.x*=e,F.y*=e)},E=[],D=F=>E.find((t=>t.$.id===F)),w=[],x=()=>{w.splice(0,w.length);for(let F of E)F.$.j&&w.push(F)},S=(F,t,e,o)=>{let i=((F,t,e,o)=>F.w+t.x<e.k+o.x&&F.g+t.y<e.V+o.y&&e.w+o.x<F.k+t.x&&e.g+o.y<F.V+t.y)(F.$.j.J,F,t.$.j.J,t);if(i){let i=((F,t)=>({x:t.x-F.x,y:t.y-F.y}))(F,t);h(i,1),A(i.x)>A(i.y)?(F.x-=i.x*e,t.x+=i.x*o,F.y=m(F.y),t.y=m(t.y)):(F.y-=i.y*e,t.y+=i.y*o,F.x=m(F.x),t.x=m(t.x))}return i},N=30,g=new AudioContext,O=1*(Math.exp(.5)-1);function P(F){let t=function(F){let t=0,e=F[5],o=Math.abs(F[6]),i=F[6]>0,r=F[7],l=F[8],a=F[13],n=F[14],f=F[11],d=F[12],X=e,c=r,u=a,s=n,W=d,b=F[0],p=F[18],Y=.1!==p,m=F[19],G=F[20],y=F[21],M=F[22],A=F[10],v=F[9],h=[F[1],F[2],F[4]],E=F[3],D=F[16],w=F[17],x=F[15],S=0,N=0,g=0,P=new Float32Array(32);for(let F=0;F<32;++F)P[F]=2*Math.random()-1;let L=0,U=0,H=0,k=0,V=0,z=new Float32Array(1024);for(let F=0;F<1024;++F)z[F]=0;let C=[];for(let F=0;0!==x&&++t>=x&&(X=e,c=r,u=a,s=n,W=d),0!==W&&F>=W&&(W=0,X*=f),c+=l,X*=c,!(X>o&&(X=o,i));++F){let F=X;v>0&&(H+=A,F=X*(1+Math.sin(H)*v));let t=Math.floor(F);if(t<8&&(t=8),u+=s,u<0&&(u=0),u>.5&&(u=.5),++U>h[L]&&(U=0,++L>2))break;let e,o=U/h[L];e=0===L?o:1===L?1+2*(1-o)*E:1-o,D+=w;let i=Math.abs(Math.floor(D));i>1023&&(i=1023),0!==M&&(y*=M,y<1e-5&&(y=1e-5),y>.1&&(y=.1));let r=0;for(let F=0;F<8;++F){let F=0;if(++k,k>=t&&(k%=t,3===b))for(let F=0;F<32;++F)P[F]=2*Math.random()-1;let o=k/t;0===b?F=o<u?.5:-.5:1===b?F=o<u?2*o/u-1:1-2*(o-u)/(1-u):2===b?F=Math.sin(2*o*Math.PI):3===b&&(F=P[32*k/t|0]);let l=S;p*=m,p<0&&(p=0),p>.1&&(p=.1),Y?(N+=(F-S)*p,N-=N*G):(S=F,N=0),S+=N,g+=S-l,g-=g*y,F=g,z[1023&V]=F,F+=z[V-i+1024&1023],V=V+1&1023,r+=F*e}C.push(r*O/8)}return new Float32Array(C)}(F),e=g.createBuffer(1,t.length,44100);return e.copyToChannel(t,0,0),e}let L=[],U=[];function H(F,t){U[F]||(U[F]=P(new Float32Array(L[F])));let e=g.createBufferSource();e.buffer=U[F];let o=g.createGain();o.gain.value=t,e.connect(o),o.connect(g.destination),e.start()}let k={q:!1,R:0},V=[4,5,6,7],z=()=>{let F=D(2),t=D(1);var e,o,i,r;F&&F.$.j&&t&&(r=t,M((i=F).x-r.x,i.y-r.y)<2&&(e=t,(o=F).x=e.x,o.y=e.y,F.$.j=void 0,x(),W(F,"z",8,0,.5,u,(()=>{t.$.T.id=12,(F=>{E.splice(E.indexOf(F),1)})(F),k.q=!0,H(0,1)}))))},C={a:1,b:0,c:0,d:1,e:0,f:0},I={a:0,b:1,c:-1,d:0,e:b,f:0},$={a:-1,b:0,c:0,d:-1,e:b,f:b},j={a:0,b:-1,c:1,d:0,e:0,f:b},J={B:!0,J:p(0,0,b,b)},K={J:p(0,0,b,b)},q={A:{Q:{id:41},T:{id:N}},Y:{Q:{id:33},j:J},C:{T:{id:31}},K:{T:{id:31,Z:I}},D:{T:{id:N,Z:j}},E:{T:{id:N,Z:I}},F:{T:{id:8},Q:{id:45}},G:{T:{id:9},Q:{id:45}},P:{T:{id:10},Q:{id:45}},S:{T:{id:13},Q:{id:45}},W:{Q:{id:45}},U:{Q:{id:44},j:J},H:{Q:{id:44},T:{id:N,Z:j}},I:{Q:{id:44},T:{id:N,Z:I}},L:{Q:{id:33},T:{id:32},j:J},M:{Q:{id:34},T:{id:32,Z:I},j:J},N:{Q:{id:35},T:{id:32,Z:$},j:J},O:{Q:{id:36},T:{id:32,Z:j},j:J},X:{j:J},a:{j:K,Q:{id:0},T:{id:1},_:8},b:{j:K,Q:{id:2},T:{id:3},_:8,id:2},u:{j:{J:p(3,10,9,7)},Q:{id:22},id:0},s:{T:{id:11},id:1},t:{Q:{id:42},T:{id:N},id:4},d:{Q:{id:4},T:{id:N},j:J,id:3}},R=["CAAAAAAtAAAAAAK","D             E","D             E","D             E","D             E","D             E","D             E","D             E","D             E","D             E","D             E","D             E","D             E","H             I"],T=[[[" WWWWWWSWWWWWW "," FFFFFFFFFFFFF "," FFPFFFFFFFFFF "," FFFFFFGGGFFFF "," FFFFFFFFFFFFF "," FFFGFFFFFFFFF "," FFFFFFFFFFFFF "," FFFFFFFFFFFFF "," FFFFFFGGGFFFF "," FFFFFFFFFFFsF "," FFFGFFFFFFFFF "," FFFGFFFFFFFFF "," FFFGFFFFFFFFF ","WFFFGFFFFFFPFFW"],[" YYYYYYdYYYYYY ","X             X","X             X","X             X","X             X","X             X","X             X","X     aaaa    X","X     a       X","X     a   b   X","X     a       X","X    aa       X","X             X","U      u      U"," XXXXXXXXXXXXX "],R],[[" WWWWWWSWWWWWW "," FFFFFFFFFFFFF "," FFPFFFFFFFFFF "," FFFFFFGGGFFFF "," FFFFFFFFFFFFF "," FFFGFFFFFFFFF "," FFFFFFFFFFFFF "," FFFFFFFFFFFFF "," FFFFFFGGGFFFF "," FFFFFFFFFFFsF "," FFFGFFFFFFFFF "," FFFGFFFPFFFFF "," FFFGFFFFFFFFF ","WFFFGFFFFFFPFFW"],[" YYYYYYdYYYYYY ","X             X","X             X","X        NOLMNX","X        M    X","X        L    X","X        O    X","X      LMN    X","XLMNaLMN      X","X         b   X","X             X","X    aa       X","X             X","U      u      U"," XXXXXXXXXXXXX "],R]];var B;!function(F){F[F.MainMenu=0]="MainMenu",F[F.Game=1]="Game",F[F.NextLevel=2]="NextLevel",F[F.GameOver=3]="GameOver"}(B||(B={}));let Q={FF:0,state:B.Game,time:0},Z=()=>{(F=>{let t=T[F];E.splice(0,E.length);let e=0;for(let F of t){let t=0,i=0;for(let r of F){for(let F of r){if(" "!==F){let r=(o=q[F],JSON.parse(JSON.stringify(o)));E.push({x:t,y:i,z:e,$:r})}t+=b}t=0,i+=b}e+=b}var o})(Q.FF),x(),k.q=!1,k.R=0,Q.time=0},_=()=>{let F=X.i,t=m(Q.time);Q.time+=F;let e=m(Q.time);if(t!=e){console.log("timer ",e);let F=5,t=13;if(e>=F&&e<=t){let o=.5*G((e-F)/(t-F),1);console.log("volume",o),H(5,o)}}Q.time>=13&&(Q.state=B.GameOver,console.log("game over"),(()=>{let F=[];for(let i=1;i<14;i++)for(let r=1;r<14;r++)F[13*r+i]=(t=0,e=1,o=v(),t+o*(e-t));var t,e,o;for(let t of E)if(t.x>0&&t.x<224&&t.y>0&&t.y<224){let e=m(t.x/b),o=F[13*m(t.y/b)+e]||0;W(t,"z",-80,o,.5,s)}H(2,1)})())},FF=[],tF={},eF={},oF=F=>eF[F],iF=(F,t)=>F.y+F.z-t.y-t.z,rF=(()=>{let F=o();return a(F,240),n(F,288),F})(),lF=e(F.getElementById("c")),aF=(F,t,f,d)=>{if(d){let X=((F,t)=>{if(void 0===t||1===t)return FF[F];{let f=tF[F];f||(tF[F]={},f=tF[F]);let d=m(255*t),X=f[d];if(!X){let c=e(FF[F]),u=r(c),s=l(c),W=o();a(W,u),n(W,s);let b=c.getImageData(0,0,u,s),p=W.getImageData(0,0,u,s),Y=b.data,m=p.data,G=0;for(;G<Y.length;)m[G]=Y[G++]*t,m[G]=Y[G++]*t,m[G]=Y[G++]*t,m[G]=Y[G++];W.putImageData(p,0,0),f[d]=i(W),X=f[d]}return X}})(d.id,d.brigthness),c=d.Z||C;F.setTransform(c.a,c.b,c.c,c.d,c.e+t,c.f+f),F.drawImage(X,0,0)}},nF=()=>{for(let o of E){let i=(F=0,t=1,e=(o.z- -48)/48,G(t,y(F,e))),r=o.$;r.Q&&(r.Q.brigthness=i),r.T&&(r.T.brigthness=i)}var F,t,e},fF=[14,15,16,17],dF=[18,19,20,21],XF=[22,23,24,25],cF=[26,27,28,29],uF={R:0};let sF=()=>{let F=D(0),t=D(3);F&&t&&A(F.x-t.x)<8&&F.y<t.y&&(console.log("win!"),Q.FF++,Q.FF=Q.FF%T.length,Z(),H(4,1))};function WF(){(()=>{let F=X.o;X.o=d(),X.i=(X.o-F)/1e3})(),Q.state==B.Game&&((()=>{let F=X.i,t=D(0);if(t){let i,r=((F=0,t=0)=>({x:F,y:t}))();if(oF(37)?(i=cF,r.x=-1):oF(39)&&(i=dF,r.x=1),oF(38)?(i=XF,r.y=-1):oF(40)&&(i=fF,r.y=1),i){uF.R+=10*F;let l=m(uF.R%i.length);t.$.Q.id=i[l],h(r,30*F),o=r,(e=t).x+=o.x,e.y+=o.y}}var e,o})(),(()=>{let F=w.length,t=20;for(;t--;){let t=0;for(let e=0;e<F;e++){let o=w[e];for(let i=e+1;i<F;i++){let F=w[i],e=!1;o.$.j.B?F.$.j.B||(e=S(o,F,0,1)):e=F.$.j.B?S(o,F,1,0):S(o,F,.5,.5),e&&t++}}if(!t)break}})(),z(),(()=>{if(k.q&&k.R<V.length){k.R+=5*X.i;let F=m(k.R),t=D(3);if(t)if(F<V.length)t.$.Q.id=V[F];else{t.$.Q=void 0,t.$.j=void 0,x();let F=D(4);F&&(F.$.Q.id=43,H(1,1))}}})(),sF(),_()),(()=>{let F=X.i;c=c.filter((t=>{if(t.offsetS>0)return t.offsetS-=F,!0;{t.m+=F;const{r:e,l:o,n:i,p:r,v:l,easing:a,h:n}=t;if(t.m>l)return e[o]=r,n&&n(),!1;{let F=a(t.m/l);return e[o]=i+(r-i)*F,!0}}}))})(),(()=>{let F=r(rF),e=l(rF),o=i(rF);f(rF),rF.fillRect(0,0,F,e),E.sort(iF),nF();for(let F of E){let t=m(F.x+0),e=m(F.y+64-F.z),o=F.$,i=o._||b;aF(rF,t,e,o.Q),aF(rF,t,e-i,o.T)}let c=innerWidth*t,u=innerHeight*t;r(lF)!=c&&a(lF,c),l(lF)!=u&&n(lF,u);let s=r(lF),W=l(lF),p=G(s/F,W/e);f(lF),lF.clearRect(0,0,s,W),lF.setTransform(p,0,0,p,0,0),lF.imageSmoothingEnabled=!1,lF.drawImage(o,0,0);{let F=(d()-X.o).toFixed(),t=(1/X.i).toFixed(),e="";lF.fillStyle="white",lF.font="arial 20px",lF.fillText(`FPS ${t}   TIME ${F} ms   ${e}`,0,20)}})(),requestAnimationFrame(WF)}!async function(){await async function(){let F=await fetch("r"),t=await F.arrayBuffer(),e=new Uint8Array(t),r=0,l=4*e[r++],f=e.slice(r,r+l);r+=l;let d=e[r++];for(;d--;){let F=e[r++],t=e[r++],l=F*t,d=e.slice(r,r+l);r+=l;let X=o();a(X,F),n(X,t);let c=X.getImageData(0,0,F,t);for(let F=0;F<d.length;F++){let t=d[F]<<2;c.data.set(f.slice(t,t+4),F<<2)}X.putImageData(c,0,0),FF.push(i(X))}let X=e[r++];for(;X--;){let F=e[r++];L.push(t.slice(r,r+F)),r+=F}}(),F.onkeydown=F=>{eF[F.keyCode]=!0},F.onkeyup=F=>{eF[F.keyCode]=void 0},Z(),WF()}()}();
