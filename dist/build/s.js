!function(){"use strict";const t=15,a=16;function n(t){return{rm:t,gm:t,bm:t,am:1,ro:0,go:0,bo:0,ao:0}}const e=document,o=devicePixelRatio;function r(t){return t.getContext("2d")}function c(){return r(e.createElement("canvas"))}const i=[],m={};function s(t,a){if(a){const n=t+"_"+function(t){return t.am+"_"+t.rm+"_"+t.gm+"_"+t.bm+"_"+t.ao+"_"+t.ro+"_"+t.go+"_"+t.bo}(a);let e=m[n];if(e)return e;const o=i[t],s=c();e=s.canvas,e.width=o.width,e.height=o.height;const h=r(o).getImageData(0,0,e.width,e.height),g=h.data,{length:l}=g,{rm:d,gm:f,bm:u,am:w,ro:v,go:b,bo:p,ao:I}=a;for(let t=0;t<l;)g[t]=g[t++]*d+v,g[t]=g[t++]*f+b,g[t]=g[t++]*u+p,g[t]=g[t++]*w+I;return s.putImageData(h,0,0),m[n]=e,console.log("apply color transform"),e}return i[t]}let h,g=performance.now();function l(){const e=function(){const t=performance.now(),a=t-g;return g=t,a/1e3}(),r=performance.now(),{world:c,screen:i}=h;c.clearRect(0,0,c.canvas.width,c.canvas.height);const m=function(t,a){const n=1-a;return{rm:n,gm:n,bm:n,am:n,ro:a*(t>>16&255),go:a*(t>>8&255),bo:a*(255&t),ao:a*(t>>24&255)}}(4283469004,.5),d=[0,1,2,0];let f=0;for(let e=0;e<t;e++)for(let o=0;o<t;o++){const r=(u=n(1-o/t),w=m,{am:u.am*w.am,rm:u.rm*w.rm,gm:u.gm*w.gm,bm:u.bm*w.bm,ao:u.am*w.ao+u.ao,ro:u.rm*w.ro+u.ro,go:u.gm*w.go+u.go,bo:u.bm*w.bo+u.bo});let i=s(d[f++%d.length],r);c.drawImage(i,o*a,e*a)}var u,w;for(let e=3;e<5;e++)for(let o=0;o<t;o++){let r=s(3,n(1-o/t));c.drawImage(r,o*a,e*a)}const v=innerWidth*o,b=innerHeight*o;i.canvas.width!=v&&(i.canvas.width=v),i.canvas.height!=b&&(i.canvas.height=b);const p=Math.min(i.canvas.width/c.canvas.width,i.canvas.height/c.canvas.height);i.clearRect(0,0,i.canvas.width,i.canvas.height),i.setTransform(p,0,0,p,0,0),i.shadowBlur=0,i.imageSmoothingEnabled=!1,i.drawImage(c.canvas,0,0);const I=(performance.now()-r).toFixed(),_=(1/e).toFixed();i.shadowBlur=10,i.shadowColor="black",i.fillStyle="white",i.font="arial 20px",i.fillText("FPS "+_+" TIME "+I+" ms",0,20),requestAnimationFrame(l)}!async function(){await async function(){const t=await fetch("r"),a=await t.arrayBuffer(),n=new Uint8Array(a);let e=0;const o=4*n[e++],r=n.slice(e,e+o);e+=o;let c=n[e++];for(;c-- >0;){const t=n[e++],a=n[e++],o=t*a,c=n.slice(e,e+o);e+=o;let m=document.createElement("canvas");m.width=t,m.height=a;let s=m.getContext("2d"),h=s.getImageData(0,0,t,a),g=0;for(let t in c){let a=4*c[t];h.data[g++]=r[a++],h.data[g++]=r[a++],h.data[g++]=r[a++],h.data[g++]=r[a]}s.putImageData(h,0,0),i.push(m)}}(),function(){const t=c();t.canvas.width=240,t.canvas.height=240;const a=r(document.getElementById("c"));h={world:t,screen:a}}(),l()}()}();
